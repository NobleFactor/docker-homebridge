
.TH Test-HomebridgeLocationGeneration 1 "31 October 2025" "docker-homebridge" "User Commands"
.SH NAME
Test-HomebridgeLocationGeneration \- Automated test for Homebridge location-based artifact and certificate generation
.SH SYNOPSIS
.B Test-HomebridgeLocationGeneration
.RI [ --test-location " <location> " ]
.br
.B Test-HomebridgeLocationGeneration
.RI [ --help ]
.SH DESCRIPTION
This script verifies that generated Homebridge artifacts for a given location match baseline reference files and certificates.
.PP
Workflow:
.IP "1." 3
Removes any previously generated artifacts, YAML, and env files for the test location.
.IP "2." 3
Generates new artifacts using build/New-HomebridgeLocation and the specified env file.
.IP "3." 3
Runs make New-HomebridgeCertificates for the location.
.IP "4." 3
Checks for existence of generated compose, env, and certificate files.
.IP "5." 3
Compares generated compose and env files to baseline using diff.
.IP "6." 3
Compares certificate-request.conf to baseline using diff.
.IP "7." 3
Performs field-by-field comparison for self-signed.csr and public-key.pem using openssl and custom extract_cert_info.
.IP "8." 3
If all comparisons pass, removes generated artifacts; if any fail, leaves them for inspection.
.PP
Generated files:
.br
	homebridge-<location>.yaml
.br
	homebridge-<location>.env
.br
	secrets/certificates/<location>/certificate-request.conf
.br
	secrets/certificates/<location>/self-signed.csr
.br
	secrets/certificates/<location>/public-key.pem
.br
Baseline files:
.br
	test/baseline/homebridge-<location>.yaml
.br
	test/baseline/homebridge-<location>.env
.br
	test/baseline/secrets/certificates/<location>/certificate-request.conf
.br
	test/baseline/secrets/certificates/<location>/self-signed.csr
.br
	test/baseline/secrets/certificates/<location>/public-key.pem
.br
.SH OPTIONS
.TP
.B --test-location <location>
Location name (e.g., 'fake-wa', 'us-wa').
.TP
.B --help
Show usage information and exit.
.SH AUTHOR
NobleFactor
.SH COPYRIGHT
Copyright 2025 NobleFactor
